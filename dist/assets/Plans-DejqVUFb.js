import{d as h,L as j,M as v,Q as _,S as P,j as e,E as I,e as o,U as l,J as w,K as z}from"./index-BNH9iTYT.js";import{C}from"./CardHeader-ip2FqKqE.js";import{L}from"./List-BkBvgyHE.js";import{L as R}from"./ListItem-B9kfCQKD.js";import{B as M}from"./Button-NFEb7akR.js";import"./ButtonBase-Djntgs0r.js";import"./isHostComponent-DVu5iVWx.js";import"./listItemButtonClasses-DRlmritA.js";import"./useId-cXK4N2WA.js";const J=()=>{const p=h(),{data:n,isLoading:y,error:b}=j(),[A,{isLoading:c}]=v(),[S,{isSuccess:T}]=_(),[f,{isSuccess:V}]=P(),d=localStorage.getItem("adminId"),g=async r=>{var s;try{const i=await S({adminId:d,planId:r}).unwrap(),u=new window.Razorpay({key:"rzp_test_Q2R8yPk3O6GHhU",amount:i.amount,currency:i.currency,name:"Society Subscription",description:i.description,order_id:i.id,handler:async t=>{var m;try{const a=await f({adminId:d,planId:r,transactionId:t.razorpay_payment_id,razorpay_order_id:t.razorpay_order_id,razorpay_signature:t.razorpay_signature}).unwrap();a.success&&(alert(a.message),localStorage.removeItem("adminId"),p("/admin-login"))}catch(a){alert(((m=a==null?void 0:a.data)==null?void 0:m.message)||"Subscription verification failed")}},prefill:{name:i.name,email:i.email,contact:i.contact},theme:{color:"#3399cc"}});u.open(),u.on("payment.failed",function(t){alert("Payment failed: "+t.error.description)})}catch(i){alert(((s=i==null?void 0:i.data)==null?void 0:s.message)||"Subscription failed")}};if(y)return e.jsx(I,{});if(b)return e.jsx(o,{color:"error",children:"Failed to load plans"});const x=(n==null?void 0:n.plans)||[];return e.jsx(l,{container:!0,spacing:3,sx:{p:2},children:x.map(r=>e.jsx(l,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(w,{variant:"outlined",children:[e.jsx(C,{title:r.name,subheader:`₹${r.price} / ${r.billingCycle}`,titleTypographyProps:{variant:"h6"}}),e.jsxs(z,{children:[e.jsx(o,{variant:"body2",gutterBottom:!0,children:r.description}),e.jsx(L,{dense:!0,children:r.features.map((s,i)=>e.jsxs(R,{children:["• ",s]},i))}),e.jsxs(o,{variant:"caption",children:["Max Residents: ",r.maxResidents]}),e.jsx("br",{}),e.jsx(M,{variant:"contained",sx:{mt:2},disabled:c,onClick:()=>g(r._id),children:c?"Subscribing...":"Subscribe"})]})]})},r._id))})};export{J as default};
