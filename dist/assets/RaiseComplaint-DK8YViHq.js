import{aT as P,r as p,j as e,P as v,aV as y,B as w,e as T,Z as x,f as S,a6 as R,a3 as g}from"./index-TOg4iC9X.js";import{T as W,a as D,b as B,c as b,d as j,e as E}from"./TableRow-Csk7A2q-.js";import{T as L}from"./TablePagination-5p5xmu9T.js";import"./MenuItem-DFBgWJ5J.js";import"./listItemTextClasses-BwEbF0GS.js";import"./dividerClasses-9ENEhr9G.js";import"./Toolbar-DEMU4rmm.js";const f=[{id:"reason",label:"Title",minWidth:170},{id:"description",label:"Description",minWidth:200},{id:"status",label:"Status",minWidth:100},{id:"createdAt",label:"Date",minWidth:170}];function A(){const{data:t,isLoading:m,error:h}=P(),[n,o]=p.useState(0),[s,l]=p.useState(10),c=(a,i)=>{o(i)},u=a=>{l(+a.target.value),o(0)};if(m)return e.jsx("div",{children:"Loading..."});if(h)return e.jsx("div",{children:"No complaints found"});const d=(t==null?void 0:t.complaints)||[];return e.jsxs(v,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(W,{sx:{maxHeight:440},children:e.jsxs(D,{stickyHeader:!0,"aria-label":"complaints table",children:[e.jsx(B,{children:e.jsx(b,{children:f.map(a=>e.jsx(j,{align:a.align,style:{minWidth:a.minWidth},children:a.label},a.id))})}),e.jsx(E,{children:d.slice(n*s,n*s+s).map((a,i)=>e.jsx(b,{hover:!0,role:"checkbox",tabIndex:-1,children:f.map(r=>e.jsx(j,{children:r.id==="createdAt"?new Date(a[r.id]).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):a[r.id]},r.id))},i))})]})}),e.jsx(L,{rowsPerPageOptions:[10,25,100],component:"div",count:d.length,rowsPerPage:s,page:n,onPageChange:c,onRowsPerPageChange:u})]})}const z=()=>{var d;const[t,m]=p.useState({reason:"",description:""}),[h,{isSuccess:n,isLoading:o,isError:s,error:l}]=y(),c=a=>{const{name:i,value:r}=a.target;m(C=>({...C,[i]:r}))},u=async a=>{a.preventDefault();try{await h(t)}catch(i){console.error("Error raising complaint",i)}};return e.jsxs(e.Fragment,{children:[e.jsxs(w,{marginBottom:2,component:"form",onSubmit:u,sx:{maxWidth:500,mx:"auto",mt:5,p:3,border:"1px solid #ccc",borderRadius:2,boxShadow:2,bgcolor:"#f9f9f9"},children:[e.jsx(T,{variant:"h5",gutterBottom:!0,children:"Raise a Complaint"}),e.jsx(x,{label:"Reason",name:"reason",value:t.reason,onChange:c,fullWidth:!0,margin:"normal",required:!0}),e.jsx(x,{label:"Description",name:"description",value:t.description,onChange:c,multiline:!0,rows:4,fullWidth:!0,margin:"normal",required:!0}),e.jsx(S,{type:"submit",variant:"contained",color:"primary",disabled:o,fullWidth:!0,sx:{mt:2},children:o?e.jsx(R,{size:24}):"Submit"}),n&&e.jsx(g,{severity:"success",sx:{mt:2},children:"Complaint raised successfully!"}),s&&e.jsx(g,{severity:"error",sx:{mt:2},children:((d=l==null?void 0:l.data)==null?void 0:d.message)||"Failed to raise complaint"})]}),e.jsx(A,{})]})};export{z as default};
