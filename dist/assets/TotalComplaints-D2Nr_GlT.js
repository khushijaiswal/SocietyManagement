import{a0 as W,r as d,a1 as R,j as t,P as I}from"./index-BNH9iTYT.js";import{T as L,a as E,b as U,c as u,d as g,e as A,f as D}from"./TableRow-Ddg_ZvjR.js";import{S as H}from"./Select-z8M_qAC4.js";import{M as l}from"./MenuItem-B6IFg_kW.js";import"./IconButton-Bk_7tTm-.js";import"./useId-cXK4N2WA.js";import"./ButtonBase-Djntgs0r.js";import"./List-BkBvgyHE.js";import"./Toolbar-__opi1CO.js";import"./Menu-DnseiFJ2.js";import"./isHostComponent-DVu5iVWx.js";import"./Modal-Dru-Vug-.js";import"./listItemTextClasses-C6NV3aj7.js";const x=[{id:"reason",label:"Title",minWidth:170},{id:"description",label:"Description",minWidth:200},{id:"status",label:"Status",minWidth:100},{id:"createdAt",label:"Date",minWidth:170},{id:"resident",label:"Resident",minWidth:170}];function V(){const{data:n,isLoading:b,error:j}=W(),[r,o]=d.useState(0),[i,P]=d.useState(10),[M,v]=d.useState(),[f,{isLoading:$}]=R(),S=(e,a)=>{o(a)},C=e=>{P(+e.target.value),o(0)},T=async(e,a)=>{try{await f({cid:e,status:a}).unwrap(),v(a),console.log("Status updated successfully")}catch(s){console.error("Error updating status",s)}};if(b)return t.jsx("div",{children:"Loading..."});if(j)return t.jsx("div",{children:"Error loading complaints."});const c=(n==null?void 0:n.complaints)||[];return t.jsxs(I,{sx:{width:"100%",overflow:"hidden"},children:[t.jsx(L,{sx:{maxHeight:440},children:t.jsxs(E,{stickyHeader:!0,"aria-label":"complaints table",children:[t.jsx(U,{children:t.jsx(u,{children:x.map(e=>t.jsx(g,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id))})}),t.jsx(A,{children:c.slice(r*i,r*i+i).map((e,a)=>t.jsx(u,{hover:!0,role:"checkbox",tabIndex:-1,children:x.map(s=>{var p,h,m;return t.jsx(g,{children:s.id==="status"?t.jsxs(H,{value:e.status,onChange:y=>T(e._id,y.target.value),size:"small",sx:{minWidth:120},disabled:e.status==="resolved",children:[t.jsx(l,{value:"open",disabled:e.status==="resolved",children:"Open"}),t.jsx(l,{value:"in-progress",disabled:e.status==="resolved",children:"In Progress"}),t.jsx(l,{value:"resolved",children:"Resolved"})]}):s.id==="createdAt"?new Date(e[s.id]).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):s.id==="resident"?`${(p=e.resident)==null?void 0:p.name} (Flat: ${(h=e.resident)==null?void 0:h.flatNumber}, Phone: ${(m=e.resident)==null?void 0:m.phone})`:e[s.id]},s.id)})},a))})]})}),t.jsx(D,{rowsPerPageOptions:[10,25,100],component:"div",count:c.length,rowsPerPage:i,page:r,onPageChange:S,onRowsPerPageChange:C})]})}export{V as default};
