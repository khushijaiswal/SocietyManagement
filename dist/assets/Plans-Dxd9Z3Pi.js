import{d as S,aj as v,ak as _,al as P,am as w,j as e,B as d,a6 as z,e as s,W as f,P as I,m as R,f as C}from"./index-TOg4iC9X.js";import{S as k}from"./Stack-BBwSDoMA.js";import{D as B}from"./listItemButtonClasses-DRsjY8op.js";import{L}from"./ListItem-EtsCeE7O.js";import"./dividerClasses-9ENEhr9G.js";const F=()=>{const l=S(),{data:o,isLoading:x,error:g}=v(),[M,{isLoading:u}]=_(),[h]=P(),[m]=w(),c=localStorage.getItem("adminId"),b=async a=>{var n;try{const r=await h({adminId:c,planId:a}).unwrap();if(r.isFree){const i=await m({adminId:c,planId:a,transactionId:r.id,razorpay_order_id:r.id,razorpay_signature:cryptoRandomSignatureStub()}).unwrap();i.success&&(alert(i.message),localStorage.removeItem("adminId"),l("/admin-login"));return}const p=new window.Razorpay({key:"rzp_test_Q2R8yPk3O6GHhU",amount:r.amount,currency:r.currency,name:"Society Subscription",description:r.description,order_id:r.id,handler:async i=>{var y;try{const t=await m({adminId:c,planId:a,transactionId:i.razorpay_payment_id,razorpay_order_id:i.razorpay_order_id,razorpay_signature:i.razorpay_signature}).unwrap();t.success&&(alert(t.message),localStorage.removeItem("adminId"),l("/admin-login"))}catch(t){alert(((y=t==null?void 0:t.data)==null?void 0:y.message)||"Subscription verification failed")}},prefill:{name:r.name,email:r.email,contact:r.contact},theme:{color:"#00796B"}});p.open(),p.on("payment.failed",function(i){alert("Payment failed: "+i.error.description)})}catch(r){alert(((n=r==null?void 0:r.data)==null?void 0:n.message)||"Subscription failed")}};if(x)return e.jsx(d,{display:"flex",justifyContent:"center",mt:4,children:e.jsx(z,{})});if(g)return e.jsx(s,{color:"error",align:"center",children:"Failed to load plans"});const j=(o==null?void 0:o.plans)||[];return e.jsxs(d,{sx:{p:{xs:2,md:4},bgcolor:"#f4f6f8",minHeight:"100vh"},children:[e.jsx(s,{variant:"h4",align:"center",gutterBottom:!0,children:"Choose a Subscription Plan"}),e.jsx(f,{container:!0,spacing:4,justifyContent:"center",children:j.map(a=>e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{elevation:3,sx:{borderRadius:3,p:3,transition:"transform 0.3s","&:hover":{transform:"scale(1.03)"}},children:e.jsxs(k,{spacing:2,children:[e.jsxs(d,{children:[e.jsx(s,{variant:"h6",color:"primary",children:a.name}),e.jsxs(s,{variant:"subtitle1",fontWeight:600,children:["₹",a.price," / ",a.billingCycle]})]}),e.jsx(B,{}),e.jsx(s,{variant:"body2",color:"text.secondary",children:a.description}),e.jsx(R,{dense:!0,children:a.features.map((n,r)=>e.jsxs(L,{sx:{pl:0},children:["• ",n]},r))}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Max Residents: ",a.maxResidents]}),e.jsx(C,{variant:"contained",size:"large",fullWidth:!0,sx:{mt:1,borderRadius:2},disabled:u,onClick:()=>b(a._id),children:u?"Subscribing...":"Subscribe Now"})]})})},a._id))})]})};export{F as default};
