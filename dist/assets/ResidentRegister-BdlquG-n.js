import{m as B,l as F,r as g,f as $,b as ve,P as H,n as k,s as y,j as s,o as w,p as E,q as Q,e as _,V as ye,W as Ce,X as Se,Y as ke,c as O,Z as T,_ as we,B as Re}from"./index-BNH9iTYT.js";import{u as je}from"./index.esm-DfrZcD0-.js";import{u as M}from"./List-BkBvgyHE.js";import{F as X,M as Pe,B as De}from"./Modal-Dru-Vug-.js";import{u as We}from"./useId-cXK4N2WA.js";import{T as m}from"./TextField-Du4Jw93l.js";import{B as v}from"./Button-NFEb7akR.js";import{T as Te,a as Me,b as Ae,c as V,d as G,e as Ne,f as Be}from"./TableRow-Ddg_ZvjR.js";import"./ButtonBase-Djntgs0r.js";import"./Select-z8M_qAC4.js";import"./Menu-DnseiFJ2.js";import"./isHostComponent-DVu5iVWx.js";import"./IconButton-Bk_7tTm-.js";import"./MenuItem-B6IFg_kW.js";import"./listItemTextClasses-C6NV3aj7.js";import"./Toolbar-__opi1CO.js";function Fe(e){return F("MuiDialog",e)}const L=B("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Z=g.createContext({}),$e=y(De,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Ee=e=>{const{classes:t,scroll:r,maxWidth:i,fullWidth:l,fullScreen:d}=e,c={root:["root"],container:["container",`scroll${w(r)}`],paper:["paper",`paperScroll${w(r)}`,`paperWidth${w(String(i))}`,l&&"paperFullWidth",d&&"paperFullScreen"]};return E(c,Fe,t)},Ue=y(Pe,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),qe=y("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.container,t[`scroll${w(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Ie=y(H,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.paper,t[`scrollPaper${w(r.scroll)}`],t[`paperWidth${w(String(r.maxWidth))}`],r.fullWidth&&t.paperFullWidth,r.fullScreen&&t.paperFullScreen]}})(Q(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:t})=>!t.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${L.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(t=>t!=="xs").map(t=>({props:{maxWidth:t},style:{maxWidth:`${e.breakpoints.values[t]}${e.breakpoints.unit}`,[`&.${L.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:t})=>t.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:t})=>t.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${L.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),ze=g.forwardRef(function(t,r){const i=$({props:t,name:"MuiDialog"}),l=ve(),d={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":c,"aria-labelledby":n,"aria-modal":o=!0,BackdropComponent:p,BackdropProps:C,children:f,className:R,disableEscapeKeyDown:x=!1,fullScreen:j=!1,fullWidth:h=!1,maxWidth:A="sm",onClick:b,onClose:P,open:N,PaperComponent:U=H,PaperProps:a={},scroll:u="paper",slots:J={},slotProps:ee={},TransitionComponent:te=X,transitionDuration:Y=d,TransitionProps:se,...re}=i,S={...i,disableEscapeKeyDown:x,fullScreen:j,fullWidth:h,maxWidth:A,scroll:u},q=Ee(S),I=g.useRef(),ae=W=>{I.current=W.target===W.currentTarget},oe=W=>{b&&b(W),I.current&&(I.current=null,P&&P(W,"backdropClick"))},z=We(n),ie=g.useMemo(()=>({titleId:z}),[z]),ne={transition:te,...J},le={transition:se,paper:a,backdrop:C,...ee},D={slots:ne,slotProps:le},[de,ce]=M("root",{elementType:Ue,shouldForwardComponentProp:!0,externalForwardedProps:D,ownerState:S,className:k(q.root,R),ref:r}),[pe,ue]=M("backdrop",{elementType:$e,shouldForwardComponentProp:!0,externalForwardedProps:D,ownerState:S}),[me,ge]=M("paper",{elementType:Ie,shouldForwardComponentProp:!0,externalForwardedProps:D,ownerState:S,className:k(q.paper,a.className)}),[he,xe]=M("container",{elementType:qe,externalForwardedProps:D,ownerState:S,className:k(q.container)}),[fe,be]=M("transition",{elementType:X,externalForwardedProps:D,ownerState:S,additionalProps:{appear:!0,in:N,timeout:Y,role:"presentation"}});return s.jsx(de,{closeAfterTransition:!0,slots:{backdrop:pe},slotProps:{backdrop:{transitionDuration:Y,as:p,...ue}},disableEscapeKeyDown:x,onClose:P,open:N,onClick:oe,...ce,...re,children:s.jsx(fe,{...be,children:s.jsx(he,{onMouseDown:ae,...xe,children:s.jsx(me,{as:U,elevation:24,role:"dialog","aria-describedby":c,"aria-labelledby":z,"aria-modal":o,...ge,children:s.jsx(Z.Provider,{value:ie,children:f})})})})})});function Le(e){return F("MuiDialogActions",e)}B("MuiDialogActions",["root","spacing"]);const _e=e=>{const{classes:t,disableSpacing:r}=e;return E({root:["root",!r&&"spacing"]},Le,t)},He=y("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableSpacing&&t.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:e})=>!e.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Ye=g.forwardRef(function(t,r){const i=$({props:t,name:"MuiDialogActions"}),{className:l,disableSpacing:d=!1,...c}=i,n={...i,disableSpacing:d},o=_e(n);return s.jsx(He,{className:k(o.root,l),ownerState:n,ref:r,...c})});function Oe(e){return F("MuiDialogContent",e)}B("MuiDialogContent",["root","dividers"]);function Xe(e){return F("MuiDialogTitle",e)}const Ve=B("MuiDialogTitle",["root"]),Ge=e=>{const{classes:t,dividers:r}=e;return E({root:["root",r&&"dividers"]},Oe,t)},Ke=y("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dividers&&t.dividers]}})(Q(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:t})=>t.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>!t.dividers,style:{[`.${Ve.root} + &`]:{paddingTop:0}}}]}))),Qe=g.forwardRef(function(t,r){const i=$({props:t,name:"MuiDialogContent"}),{className:l,dividers:d=!1,...c}=i,n={...i,dividers:d},o=Ge(n);return s.jsx(Ke,{className:k(o.root,l),ownerState:n,ref:r,...c})}),Ze=e=>{const{classes:t}=e;return E({root:["root"]},Xe,t)},Je=y(_,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),et=g.forwardRef(function(t,r){const i=$({props:t,name:"MuiDialogTitle"}),{className:l,id:d,...c}=i,n=i,o=Ze(n),{titleId:p=d}=g.useContext(Z);return s.jsx(Je,{component:"h2",className:k(o.root,l),ownerState:n,ref:r,variant:"h6",id:d??p,...c})}),K=[{id:"name",label:"Name",minWidth:170,align:"left"},{id:"email",label:"Email",minWidth:200,align:"left"},{id:"phone",label:"Phone",minWidth:100,align:"left"},{id:"address",label:"Address",minWidth:170,align:"left"},{id:"flatNumber",label:"Flat Number",minWidth:170,align:"left"},{id:"isActive",label:"isActive?",minWidth:170,align:"left"},{id:"Actions",label:"Actions",minWidth:170,align:"left"}],tt=()=>{const{data:e,refetch:t}=ye(),[r,{isSuccess:i}]=Ce(),[l,{isSuccess:d}]=Se(),[c,n]=g.useState(!1),[o,p]=g.useState({name:"",email:"",phone:"",address:"",flatNumber:"",isActive:!0}),C=a=>{p(a),t(),n(!0)},[f,{isloading:R,isSuccess:x}]=ke(),j=async a=>{if(window.confirm("Are you sure you want to delete this resident?"))try{await r(a).unwrap(),T.success("Resident deleted successfully"),t()}catch(u){T.error("Failed to delete resident"),console.error(u)}},[h,A]=O.useState(0),[b,P]=O.useState(10),N=(a,u)=>{A(u)},U=a=>{P(+a.target.value),A(0)};return g.useEffect(()=>{x&&(T.success("user block success"),t())},[x]),s.jsxs(s.Fragment,{children:[s.jsxs(ze,{open:c,onClose:()=>n(!1),fullWidth:!0,maxWidth:"sm",children:[s.jsx(et,{children:"Edit Resident"}),s.jsxs(Qe,{dividers:!0,children:[s.jsx(m,{label:"Name",value:o.name,fullWidth:!0,margin:"dense",onChange:a=>p({...o,name:a.target.value})}),s.jsx(m,{label:"Email",value:o.email,fullWidth:!0,margin:"dense",onChange:a=>p({...o,email:a.target.value})}),s.jsx(m,{label:"Phone",value:o.phone,fullWidth:!0,margin:"dense",onChange:a=>p({...o,phone:a.target.value})}),s.jsx(m,{label:"Address",value:o.address,fullWidth:!0,margin:"dense",onChange:a=>p({...o,address:a.target.value})}),s.jsx(m,{label:"Flat Number",value:o.flatNumber,fullWidth:!0,margin:"dense",onChange:a=>p({...o,flatNumber:a.target.value})})]}),s.jsxs(Ye,{children:[s.jsx(v,{onClick:()=>n(!1),color:"error",children:"Cancel"}),s.jsx(v,{onClick:async()=>{try{await l({rid:o._id,updateData:o}).unwrap(),t(),T.success("Resident updated successfully"),n(!1)}catch(a){T.error("Failed to update resident"),console.error(a)}},color:"primary",variant:"contained",children:"Save"})]})]}),s.jsxs(H,{sx:{width:"100%",overflow:"hidden"},children:[s.jsx(Te,{sx:{maxHeight:440},children:s.jsxs(Me,{stickyHeader:!0,"aria-label":"Resident table",children:[s.jsx(Ae,{children:s.jsx(V,{children:K.map(a=>s.jsx(G,{align:a.align,style:{minWidth:a.minWidth},children:a.label},a.id))})}),s.jsx(Ne,{children:e==null?void 0:e.residents.slice(h*b,h*b+b).map(a=>s.jsx(V,{hover:!0,role:"checkbox",tabIndex:-1,children:K.map(u=>s.jsx(G,{align:u.align||"left",children:u.id==="Actions"?s.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[s.jsx(v,{variant:"contained",color:"success",size:"small",onClick:()=>C(a),children:"Edit"}),s.jsx(v,{variant:"outlined",color:"error",size:"small",onClick:()=>j(a._id),children:"Delete"}),a.isActive?s.jsx(v,{variant:"contained",color:"warning",size:"small",onClick:async()=>{await f({rid:a._id,isActive:!1}).unwrap(),t()},children:"Block"}):s.jsx(v,{variant:"contained",color:"success",size:"small",onClick:async()=>{await f({rid:a._id,isActive:!0}).unwrap(),t()},children:"Unblock"})]}):u.id==="isActive"?a.isActive?"true":"false":a[u.id]},u.id))},a._id||a.email))})]})}),s.jsx(Be,{rowsPerPageOptions:[10,25,100],component:"div",count:(e==null?void 0:e.residents.length)||0,rowsPerPage:b,page:h,onPageChange:N,onRowsPerPageChange:U})]})]})},bt=()=>{var n,o,p,C,f,R,x;const{register:e,handleSubmit:t,formState:{errors:r}}=je(),[i,{isLoading:l,error:d}]=we(),c=async j=>{try{const h=await i(j);console.log("Resident registered successfully:",h)}catch(h){console.error("Error registering resident:",h)}};return s.jsxs(s.Fragment,{children:[s.jsxs(Re,{marginBottom:2,component:"form",onSubmit:t(c),sx:{padding:3,backgroundColor:"background.paper",borderRadius:2,maxWidth:400,margin:"auto"},children:[s.jsx(_,{variant:"h6",gutterBottom:!0,children:"Resident Registration Form"}),s.jsx(m,{label:"Name",variant:"outlined",fullWidth:!0,margin:"normal",...e("name",{required:"Name is required"}),error:!!r.name,helperText:(n=r.name)==null?void 0:n.message}),s.jsx(m,{label:"Email",variant:"outlined",fullWidth:!0,margin:"normal",...e("email",{required:"Email is required",pattern:{value:/^\S+@\S+$/i,message:"Invalid email format"}}),error:!!r.email,helperText:(o=r.email)==null?void 0:o.message}),s.jsx(m,{label:"Phone",variant:"outlined",fullWidth:!0,margin:"normal",...e("phone",{required:"Phone is required"}),error:!!r.phone,helperText:(p=r.phone)==null?void 0:p.message}),s.jsx(m,{label:"Flat Number",variant:"outlined",fullWidth:!0,margin:"normal",...e("flatNumber",{required:"Flat Number is required"}),error:!!r.flatNumber,helperText:(C=r.flatNumber)==null?void 0:C.message}),s.jsx(m,{label:"Addrees",variant:"outlined",fullWidth:!0,margin:"normal",...e("address",{required:"Address is required"}),error:!!r.address,helperText:(f=r.address)==null?void 0:f.message}),s.jsx(m,{label:"Password",type:"password",variant:"outlined",fullWidth:!0,margin:"normal",...e("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),error:!!r.password,helperText:(R=r.password)==null?void 0:R.message}),s.jsx(v,{type:"submit",variant:"contained",fullWidth:!0,sx:{mt:2},disabled:l,color:"secondary",children:l?"Registering...":"Register Resident"}),d&&s.jsxs(_,{color:"error",sx:{mt:2},children:["Registration failed: ",((x=d.data)==null?void 0:x.message)||"Unknown error"]})]}),s.jsx(tt,{})]})};export{bt as default};
