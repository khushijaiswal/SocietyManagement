import{r as h,w as Ce,ad as Se,b9 as $,ba as W,bb as we,bc as V,F as ee,G as te,h as ne,j as e,s as N,x as Ee,y as oe,P as se,C as re,bd as Ae,b as Pe,S as H,be as Re,H as z,b7 as Te,bf as De,bg as Le,B as X,a6 as _,e as E,f as L,a3 as Me}from"./index-TOg4iC9X.js";import{T as Oe,a as Be,b as He,c as K,d as y,e as ze}from"./TableRow-Csk7A2q-.js";import{D as Q,a as q,b as Y,c as J}from"./DialogTitle-DHDfifRQ.js";function Z(t){return t.substring(2).toLowerCase()}function Ne(t,n){return n.documentElement.clientWidth<t.clientX||n.documentElement.clientHeight<t.clientY}function Fe(t){const{children:n,disableReactTree:a=!1,mouseEvent:s="onClick",onClickAway:g,touchEvent:f="onTouchEnd"}=t,m=h.useRef(!1),l=h.useRef(null),u=h.useRef(!1),v=h.useRef(!1);h.useEffect(()=>(setTimeout(()=>{u.current=!0},0),()=>{u.current=!1}),[]);const x=Ce(Se(n),l),b=$(o=>{const p=v.current;v.current=!1;const j=W(l.current);if(!u.current||!l.current||"clientX"in o&&Ne(o,j))return;if(m.current){m.current=!1;return}let r;o.composedPath?r=o.composedPath().includes(l.current):r=!j.documentElement.contains(o.target)||l.current.contains(o.target),!r&&(a||!p)&&g(o)}),C=o=>p=>{v.current=!0;const j=n.props[o];j&&j(p)},A={ref:x};return f!==!1&&(A[f]=C(f)),h.useEffect(()=>{if(f!==!1){const o=Z(f),p=W(l.current),j=()=>{m.current=!0};return p.addEventListener(o,b),p.addEventListener("touchmove",j),()=>{p.removeEventListener(o,b),p.removeEventListener("touchmove",j)}}},[b,f]),s!==!1&&(A[s]=C(s)),h.useEffect(()=>{if(s!==!1){const o=Z(s),p=W(l.current);return p.addEventListener(o,b),()=>{p.removeEventListener(o,b)}}},[b,s]),h.cloneElement(n,A)}function Ue(t={}){const{autoHideDuration:n=null,disableWindowBlurListener:a=!1,onClose:s,open:g,resumeHideDuration:f}=t,m=we();h.useEffect(()=>{if(!g)return;function r(i){i.defaultPrevented||i.key==="Escape"&&(s==null||s(i,"escapeKeyDown"))}return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}},[g,s]);const l=$((r,i)=>{s==null||s(r,i)}),u=$(r=>{!s||r==null||m.start(r,()=>{l(null,"timeout")})});h.useEffect(()=>(g&&u(n),m.clear),[g,n,u,m]);const v=r=>{s==null||s(r,"clickaway")},x=m.clear,b=h.useCallback(()=>{n!=null&&u(f??n*.5)},[n,f,u]),C=r=>i=>{const d=r.onBlur;d==null||d(i),b()},A=r=>i=>{const d=r.onFocus;d==null||d(i),x()},o=r=>i=>{const d=r.onMouseEnter;d==null||d(i),x()},p=r=>i=>{const d=r.onMouseLeave;d==null||d(i),b()};return h.useEffect(()=>{if(!a&&g)return window.addEventListener("focus",b),window.addEventListener("blur",x),()=>{window.removeEventListener("focus",b),window.removeEventListener("blur",x)}},[a,g,b,x]),{getRootProps:(r={})=>{const i={...V(t),...V(r)};return{role:"presentation",...r,...i,onBlur:C(i),onFocus:A(i),onMouseEnter:o(i),onMouseLeave:p(i)}},onClickAway:v}}function Ie(t){return ee("MuiSnackbarContent",t)}te("MuiSnackbarContent",["root","message","action"]);const We=t=>{const{classes:n}=t;return oe({root:["root"],action:["action"],message:["message"]},Ie,n)},$e=N(se,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,n)=>n.root})(re(({theme:t})=>{const n=t.palette.mode==="light"?.8:.98,a=Ae(t.palette.background.default,n);return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(a),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:a,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),Ge=N("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,n)=>n.message})({padding:"8px 0"}),Ve=N("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,n)=>n.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Xe=h.forwardRef(function(n,a){const s=ne({props:n,name:"MuiSnackbarContent"}),{action:g,className:f,message:m,role:l="alert",...u}=s,v=s,x=We(v);return e.jsxs($e,{role:l,square:!0,elevation:6,className:Ee(x.root,f),ownerState:v,ref:a,...u,children:[e.jsx(Ge,{className:x.message,ownerState:v,children:m}),g?e.jsx(Ve,{className:x.action,ownerState:v,children:g}):null]})});function _e(t){return ee("MuiSnackbar",t)}te("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Ke=t=>{const{classes:n,anchorOrigin:a}=t,s={root:["root",`anchorOrigin${z(a.vertical)}${z(a.horizontal)}`]};return oe(s,_e,n)},Qe=N("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:a}=t;return[n.root,n[`anchorOrigin${z(a.anchorOrigin.vertical)}${z(a.anchorOrigin.horizontal)}`]]}})(re(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:n})=>n.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:n})=>n.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:n})=>n.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:n})=>n.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:n})=>n.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),qe=h.forwardRef(function(n,a){const s=ne({props:n,name:"MuiSnackbar"}),g=Pe(),f={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen},{action:m,anchorOrigin:{vertical:l,horizontal:u}={vertical:"bottom",horizontal:"left"},autoHideDuration:v=null,children:x,className:b,ClickAwayListenerProps:C,ContentProps:A,disableWindowBlurListener:o=!1,message:p,onBlur:j,onClose:r,onFocus:i,onMouseEnter:d,onMouseLeave:F,open:T,resumeHideDuration:U,slots:D={},slotProps:M={},TransitionComponent:c,transitionDuration:S=f,TransitionProps:{onEnter:O,onExited:I,...ie}={},...ae}=s,R={...s,anchorOrigin:{vertical:l,horizontal:u},autoHideDuration:v,disableWindowBlurListener:o,TransitionComponent:c,transitionDuration:S},ce=Ke(R),{getRootProps:le,onClickAway:ue}=Ue({...R}),[de,G]=h.useState(!0),pe=k=>{G(!0),I&&I(k)},he=(k,w)=>{G(!1),O&&O(k,w)},B={slots:{transition:c,...D},slotProps:{content:A,clickAwayListener:C,transition:ie,...M}},[fe,me]=H("root",{ref:a,className:[ce.root,b],elementType:Qe,getSlotProps:le,externalForwardedProps:{...B,...ae},ownerState:R}),[ge,{ownerState:xe,...be}]=H("clickAwayListener",{elementType:Fe,externalForwardedProps:B,getSlotProps:k=>({onClickAway:(...w)=>{var P;(P=k.onClickAway)==null||P.call(k,...w),ue(...w)}}),ownerState:R}),[ye,ve]=H("content",{elementType:Xe,shouldForwardComponentProp:!0,externalForwardedProps:B,additionalProps:{message:p,action:m},ownerState:R}),[ke,je]=H("transition",{elementType:Re,externalForwardedProps:B,getSlotProps:k=>({onEnter:(...w)=>{var P;(P=k.onEnter)==null||P.call(k,...w),he(...w)},onExited:(...w)=>{var P;(P=k.onExited)==null||P.call(k,...w),pe(...w)}}),additionalProps:{appear:!0,in:T,timeout:S,direction:l==="top"?"down":"up"},ownerState:R});return!T&&de?null:e.jsx(ge,{...be,...D.clickAwayListener&&{ownerState:xe},children:e.jsx(fe,{...me,children:e.jsx(ke,{...je,children:x||e.jsx(ye,{...ve})})})})}),et=()=>{var F,T,U,D,M;const{data:t,isLoading:n,error:a,refetch:s}=Te(),[g,{isLoading:f}]=De(),[m,l]=h.useState({open:!1,message:"",severity:"success"}),[u,v]=h.useState({open:!1,society:null}),x=()=>l({...m,open:!1}),b=c=>v({open:!0,society:c}),C=()=>v({open:!1,society:null}),[A]=Le(),[o,p]=h.useState({open:!1,data:null}),j=async()=>{const{_id:c,isActive:S,name:O}=u.society;try{await g({aid:c,isActive:!S}).unwrap(),l({open:!0,message:`${O} has been ${S?"blocked":"unblocked"} successfully.`,severity:"success"}),s()}catch{l({open:!0,message:"Something went wrong. Please try again.",severity:"error"})}finally{C()}},r=async c=>{try{const S=await A(c).unwrap();p({open:!0,data:S})}catch{l({open:!0,message:"Failed to fetch society details.",severity:"error"})}},i=()=>{p({open:!1,data:null})};if(n)return e.jsx(X,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(_,{})});if(a)return e.jsx(E,{color:"error",children:"Error loading societies."});const d=(t==null?void 0:t.admins)||[];return e.jsxs(X,{children:[e.jsxs(E,{variant:"h5",gutterBottom:!0,children:["Total Societies: ",d.length]}),e.jsx(Oe,{component:se,children:e.jsxs(Be,{children:[e.jsx(He,{children:e.jsxs(K,{children:[e.jsx(y,{children:"#"}),e.jsx(y,{children:"Society Name"}),e.jsx(y,{children:"Admin Name"}),e.jsx(y,{children:"Email"}),e.jsx(y,{children:"Phone"}),e.jsx(y,{children:"Status"}),e.jsx(y,{children:"Created At"}),e.jsx(y,{children:"Action"})]})}),e.jsx(ze,{children:d.map((c,S)=>e.jsxs(K,{children:[e.jsx(y,{children:S+1}),e.jsx(y,{children:c.societyName}),e.jsx(y,{children:c.name}),e.jsx(y,{children:c.email}),e.jsx(y,{children:c.phone}),e.jsx(y,{children:c.isActive?"Active":"Inactive"}),e.jsx(y,{children:new Date(c.createdAt).toLocaleDateString()}),e.jsxs(y,{children:[e.jsx(L,{variant:"text",color:c.isActive?"error":"success",size:"small",onClick:()=>b(c),disabled:f,children:c.isActive?"Block":"Unblock"}),e.jsx(L,{variant:"text",color:"secondary",size:"small",disabled:f,onClick:()=>r(c._id),children:"View Details"})]})]},c._id))})]})}),e.jsx(qe,{open:m.open,autoHideDuration:3e3,onClose:x,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(Me,{onClose:x,severity:m.severity,sx:{width:"100%"},children:m.message})}),e.jsxs(Q,{open:u.open,onClose:C,children:[e.jsx(q,{children:"Confirm Action"}),e.jsxs(Y,{children:["Are you sure you want to ",(F=u.society)!=null&&F.isActive?"block":"unblock"," ",e.jsx("strong",{children:(T=u.society)==null?void 0:T.name}),"?"]}),e.jsxs(J,{children:[e.jsx(L,{onClick:C,color:"inherit",children:"Cancel"}),e.jsx(L,{onClick:j,color:(U=u.society)!=null&&U.isActive?"error":"success",variant:"contained",children:(D=u.society)!=null&&D.isActive?"Block":"Unblock"})]})]}),e.jsxs(Q,{open:o.open,onClose:i,maxWidth:"sm",fullWidth:!0,children:[e.jsx(q,{children:"Society Details"}),e.jsx(Y,{dividers:!0,children:o.data?e.jsxs(e.Fragment,{children:[e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Society Name:"})," ",o.data.society.societyName]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Admin:"})," ",o.data.society.name]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Email:"})," ",o.data.society.email]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Phone:"})," ",o.data.society.phone]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Residents:"})," ",o.data.residentCount]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Subscription Plan:"})," ",((M=o.data.society.subscriptionPlan)==null?void 0:M.name)||"Not Subscribed"]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Status:"})," ",o.data.society.isActive?"Active":"Inactive"]}),e.jsxs(E,{variant:"subtitle1",children:[e.jsx("strong",{children:"Created At:"})," ",new Date(o.data.society.createdAt).toLocaleString()]})]}):e.jsx(_,{})}),e.jsx(J,{children:e.jsx(L,{onClick:i,color:"primary",children:"Close"})})]})]})};export{et as default};
