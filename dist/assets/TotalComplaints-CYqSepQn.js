import{aG as W,r as d,aH as R,j as t,P as I,aI as L}from"./index-TOg4iC9X.js";import{T as E,a as H,b as U,c as m,d as g,e as A}from"./TableRow-Csk7A2q-.js";import{M as l}from"./MenuItem-DFBgWJ5J.js";import{T as D}from"./TablePagination-5p5xmu9T.js";import"./listItemTextClasses-BwEbF0GS.js";import"./dividerClasses-9ENEhr9G.js";import"./Toolbar-DEMU4rmm.js";const x=[{id:"reason",label:"Title",minWidth:170},{id:"description",label:"Description",minWidth:200},{id:"status",label:"Status",minWidth:100},{id:"createdAt",label:"Date",minWidth:170},{id:"resident",label:"Resident",minWidth:170}];function F(){const{data:n,isLoading:b,error:j}=W(),[r,o]=d.useState(0),[i,P]=d.useState(10),[M,v]=d.useState(),[f,{isLoading:$}]=R(),S=(e,a)=>{o(a)},T=e=>{P(+e.target.value),o(0)},C=async(e,a)=>{try{await f({cid:e,status:a}).unwrap(),v(a),console.log("Status updated successfully")}catch(s){console.error("Error updating status",s)}};if(b)return t.jsx("div",{children:"Loading..."});if(j)return t.jsx("div",{children:"Error loading complaints."});const c=(n==null?void 0:n.complaints)||[];return t.jsxs(I,{sx:{width:"100%",overflow:"hidden"},children:[t.jsx(E,{sx:{maxHeight:440},children:t.jsxs(H,{stickyHeader:!0,"aria-label":"complaints table",children:[t.jsx(U,{children:t.jsx(m,{children:x.map(e=>t.jsx(g,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id))})}),t.jsx(A,{children:c.slice(r*i,r*i+i).map((e,a)=>t.jsx(m,{hover:!0,role:"checkbox",tabIndex:-1,children:x.map(s=>{var h,u,p;return t.jsx(g,{children:s.id==="status"?t.jsxs(L,{value:e.status,onChange:y=>C(e._id,y.target.value),size:"small",sx:{minWidth:120},disabled:e.status==="resolved",children:[t.jsx(l,{value:"open",disabled:e.status==="resolved",children:"Open"}),t.jsx(l,{value:"in-progress",disabled:e.status==="resolved",children:"In Progress"}),t.jsx(l,{value:"resolved",children:"Resolved"})]}):s.id==="createdAt"?new Date(e[s.id]).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):s.id==="resident"?`${(h=e.resident)==null?void 0:h.name} (Flat: ${(u=e.resident)==null?void 0:u.flatNumber}, Phone: ${(p=e.resident)==null?void 0:p.phone})`:e[s.id]},s.id)})},a))})]})}),t.jsx(D,{rowsPerPageOptions:[10,25,100],component:"div",count:c.length,rowsPerPage:i,page:r,onPageChange:S,onRowsPerPageChange:T})]})}export{F as default};
